<html>
  <head>
    <title>HOPR Admin</title>
<style>
body {
  background: linear-gradient(#000050, #0000b4); /* Dark Blue to bright blue */
  color: #b4f0ff; /* Sky Blue */
  height: 100vh;
  font-family: monospace;
  padding: 0 2rem;
  overflow: hidden;
}
.logs {
  display: block;
  border: 1px solid #3c64a5; /* Steel Blue */
  background-color: #b4f0ff; /* Sky Blue */
  color: #000050; /* Dark Blue */
  padding: 1rem;
  margin: 0;
  position: fixed; 
  top: 4rem; 
  bottom: 5rem;
  left: 2rem;
  right: 2rem;
  overflow-y: scroll;
}
.connecting {
  background-color: #ffffa0; /* HOPR Yellow */
  color: red;
}
.logo {
  width: 100px;
  height: 100px;
  position: fixed;
  top: 1rem;
  right: 1rem;
  z-index:5;
}

.send {
  position: fixed;
  bottom: 0rem;
  left: 0rem;
  right: 0rem;
  background-color:  #000050;
  color: #b4f0ff;
  border-top: 1px solid #b4f0ff;
}

.send input {
  background: transparent;
  color: #b4f0ff;
  border: none;
  width:100%;
  padding: 1rem;
  font-family: monospace;
  font-size: 1.2rem;
}

</style>
<script>

var prevLog = ""

var appendLog = function(msg){
  var logs = document.querySelector('#log')
  logs.textContent = logs.textContent + '\n'+ msg
  logs.scrollIntoView({block: 'end', behaviour: 'smooth'});
}

var connect = function(){
  var logs = document.querySelector('.logs')
  console.log('Connecting ...')
  var client = new WebSocket('ws://' + window.location.host);
  console.log('Web socket created')

  client.onopen = function(){
    console.log('Web socket opened')
    logs.classList.remove('connecting')

    document.querySelector('#command').onkeydown = function(e) {
      if (e.keyCode == 13 ) { // enter 
        var text = e.target.value 
        console.log("Command: ", text)
        if (text.length > 0) {
          client.send(text)
          prevLog = text
          e.target.value = ""
        }
      }
      if (e.keyCode == 38) { // Up Arrow
        e.target.value = prevLog
      }
    }

  }

  client.onmessage = function(event) {
    appendLog(event.data)
    console.log(event)
  }

  client.onerror = function(error){
    console.log('Connection error:', error)
  }

  client.onclose = function(){
    console.log('Web socket closed')
    logs.classList.add('connecting')
    appendLog(' --- < Lost Connection, attempting to reconnect... > ---')
    setTimeout(function(){
      try {
        connect()
        console.log('connection')
      } catch (e){
        console.log('Error connecting', e)
      }
    }, 1000);
  }
}

window.onload = function(){
  connect();
}
</script>
  </head>
  <body>
    <div class='logo'>
      <svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 196 196' style='enable-background:new 0 0 196 196;' xml:space='preserve'>
  <circle cx='98' cy='98' r='98' fill='#FFFFA0' />
  <linearGradient id='G' gradientUnits='userSpaceOnUse' x1='102' y1='163.0232' x2='102' y2='57.4945'>
    <stop offset='0' style='stop-color:#0000B4' />
    <stop offset='9.090910e-03' style='stop-color:#0000B4' />
    <stop offset='1' style='stop-color:#000050' />
  </linearGradient>
  <path fill='url(#G)' d='M115.9,61.7c-1.1-0.1-2.2-0.2-3.3-0.2c-8.2,0-16.3,3.3-23.5,9.8c-3.4,3-6.5,6.6-9.4,10.8
    c-0.5-15.6-1.4-32.2-2.9-49.1H55.6c4.5,47.7,4,89.3,3.2,125.8h0c0,0.1,0,0.1,0,0.2h21c0.6-36.6,9.8-60,23.3-72.1
    c3.6-3.3,7.2-4.7,10.5-4.4c16.6,1.8,14,53.6,12.7,76.5h21c0.9-16.9,1.9-37.5-0.5-55.5C143.3,77.6,132.9,63.6,115.9,61.7z'/>
      </svg>
    </div>
    <h1>HOPR Logs [TESTNET NODE]</h1>
    <div class='logs' class='connecting'>
    <pre><code id='log'>Connecting...</code></pre>
    </div>
    <div class='send'>
      <input id="command" type="text" placeholder="type 'help' for full list of commands" /> 
    </div>
  </body>
</html>
